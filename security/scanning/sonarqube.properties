# File: security/scanning/sonarqube.properties
# SonarQube Configuration for Security and Code Quality Analysis

# ===============================================
# PROJECT CONFIGURATION
# ===============================================

# Project identification
sonar.projectKey=company-project
sonar.projectName=Company Project
sonar.projectVersion=1.0.0
sonar.projectDescription=Main application with security scanning enabled

# Project source settings
sonar.sources=src,app,lib
sonar.tests=tests,test
sonar.sourceEncoding=UTF-8
sonar.projectBaseDir=.

# Language-specific configurations
sonar.python.version=3.8,3.9,3.10,3.11,3.12
sonar.javascript.environments=browser,node,jest
sonar.java.source=11
sonar.java.target=11

# ===============================================
# EXCLUSIONS AND INCLUSIONS
# ===============================================

# Global exclusions (files/directories to exclude from all analysis)
sonar.exclusions=\
    **/node_modules/**,\
    **/venv/**,\
    **/virtualenv/**,\
    **/.venv/**,\
    **/build/**,\
    **/dist/**,\
    **/target/**,\
    **/__pycache__/**,\
    **/*.pyc,\
    **/migrations/**,\
    **/static/**,\
    **/media/**,\
    **/docs/**,\
    **/.git/**,\
    **/.pytest_cache/**,\
    **/coverage/**,\
    **/htmlcov/**,\
    **/logs/**,\
    **/tmp/**,\
    **/temp/**,\
    **/*.min.js,\
    **/*.min.css,\
    **/vendor/**,\
    **/third_party/**,\
    **/lib/external/**

# Test exclusions (files/directories to exclude from main code analysis but include in test analysis)
sonar.test.exclusions=\
    **/conftest.py,\
    **/fixtures/**,\
    **/mock_data/**

# Coverage exclusions (files to exclude from coverage analysis)
sonar.coverage.exclusions=\
    **/test_*.py,\
    **/*_test.py,\
    **/tests/**,\
    **/conftest.py,\
    **/setup.py,\
    **/manage.py,\
    **/wsgi.py,\
    **/asgi.py,\
    **/settings/**,\
    **/config/**

# Duplication exclusions (files to exclude from duplication analysis)
sonar.cpd.exclusions=\
    **/migrations/**,\
    **/templates/**,\
    **/locale/**

# ===============================================
# SECURITY CONFIGURATION
# ===============================================

# Security hotspot detection
sonar.security.hotspots.enable=true
sonar.security.hotspots.inheritance=true

# Security rules configuration
sonar.python.security.enable=true
sonar.javascript.security.enable=true
sonar.java.security.enable=true

# OWASP Top 10 categories
sonar.security.owasp.a1.enable=true  # Injection
sonar.security.owasp.a2.enable=true  # Broken Authentication
sonar.security.owasp.a3.enable=true  # Sensitive Data Exposure
sonar.security.owasp.a4.enable=true  # XML External Entities (XXE)
sonar.security.owasp.a5.enable=true  # Broken Access Control
sonar.security.owasp.a6.enable=true  # Security Misconfiguration
sonar.security.owasp.a7.enable=true  # Cross-Site Scripting (XSS)
sonar.security.owasp.a8.enable=true  # Insecure Deserialization
sonar.security.owasp.a9.enable=true  # Using Components with Known Vulnerabilities
sonar.security.owasp.a10.enable=true # Insufficient Logging & Monitoring

# CWE (Common Weakness Enumeration) security rules
sonar.security.cwe.enable=true

# SANS Top 25 security rules
sonar.security.sans.enable=true

# ===============================================
# CODE QUALITY GATES
# ===============================================

# Quality gate settings
sonar.qualitygate.wait=true
sonar.qualitygate.timeout=300

# Quality gate conditions
sonar.quality.gate.coverage.minimum=80.0
sonar.quality.gate.duplication.maximum=3.0
sonar.quality.gate.maintainability.rating=A
sonar.quality.gate.reliability.rating=A
sonar.quality.gate.security.rating=A

# Bug and vulnerability thresholds
sonar.quality.gate.bugs.new=0
sonar.quality.gate.vulnerabilities.new=0
sonar.quality.gate.security_hotspots.new=0
sonar.quality.gate.code_smells.new=10

# Technical debt thresholds
sonar.quality.gate.sqale_rating.new=A
sonar.quality.gate.sqale_debt_ratio.new=5.0

# ===============================================
# COVERAGE CONFIGURATION
# ===============================================

# Python coverage
sonar.python.coverage.reportPaths=coverage.xml,reports/coverage.xml
sonar.python.xunit.reportPath=reports/pytest.xml

# JavaScript/TypeScript coverage
sonar.javascript.lcov.reportPaths=coverage/lcov.info
sonar.typescript.lcov.reportPaths=coverage/lcov.info

# Java coverage
sonar.java.coveragePlugin=jacoco
sonar.jacoco.reportPaths=target/site/jacoco/jacoco.exec

# Generic coverage format
sonar.coverageReportPaths=reports/coverage-generic.xml

# ===============================================
# ANALYSIS CONFIGURATION
# ===============================================

# Analysis mode
sonar.analysis.mode=publish
sonar.issuesReport.html.enable=true
sonar.issuesReport.console.enable=true

# Scanner behavior
sonar.scanner.skip=false
sonar.scanner.metadataFilePath=.scannerwork/report-task.txt
sonar.working.directory=.scannerwork

# Performance settings
sonar.ce.gracefulStopTimeout=PT30S
sonar.web.gracefulStopTimeout=PT30S

# ===============================================
# LANGUAGE-SPECIFIC RULES
# ===============================================

# Python specific rules
sonar.python.bandit.reportPaths=reports/bandit.json
sonar.python.pylint.reportPath=reports/pylint.txt
sonar.python.flake8.reportPath=reports/flake8.txt
sonar.python.mypy.reportPath=reports/mypy.txt

# Security rules for Python
sonar.python.S101.activate=true    # Use of "assert"
sonar.python.S105.activate=true    # Hard-coded passwords
sonar.python.S106.activate=true    # Hard-coded credentials
sonar.python.S110.activate=true    # Overly permissive file permissions
sonar.python.S324.activate=true    # Weak cryptographic hash
sonar.python.S325.activate=true    # Insecure hash function
sonar.python.S501.activate=true    # Requests verify disabled
sonar.python.S506.activate=true    # Weak SSL/TLS protocols

# JavaScript/TypeScript specific rules
sonar.javascript.environments=browser,node,jquery,jest,jasmine
sonar.javascript.globals=angular,require,module,exports

# Security rules for JavaScript
sonar.javascript.S1523.activate=true   # Dynamically executing code
sonar.javascript.S2612.activate=true   # Setting loose POSIX file permissions
sonar.javascript.S2755.activate=true   # XML parsers should not be vulnerable to XXE attacks
sonar.javascript.S3330.activate=true   # Creating cookies without the "HttpOnly" flag
sonar.javascript.S3331.activate=true   # Creating cookies without the "secure" flag
sonar.javascript.S4426.activate=true   # Cryptographic keys should be robust
sonar.javascript.S4507.activate=true   # Delivering code in production with debug features activated
sonar.javascript.S4817.activate=true   # Executing XPATH expressions
sonar.javascript.S4818.activate=true   # Using sockets is security-sensitive
sonar.javascript.S4823.activate=true   # Using command line arguments is security-sensitive
sonar.javascript.S4829.activate=true   # Reading the Standard Input is security-sensitive
sonar.javascript.S5122.activate=true   # Having a permissive Cross-Origin Resource Sharing policy

# Java specific rules (if applicable)
sonar.java.binaries=target/classes
sonar.java.libraries=lib/*.jar

# Security rules for Java
sonar.java.S128.activate=true     # Switch cases should end with an unconditional "break" statement
sonar.java.S2076.activate=true    # OS commands should not be vulnerable to injection attacks
sonar.java.S2077.activate=true    # Values passed to SQL commands should be sanitized
sonar.java.S2078.activate=true    # Values passed to LDAP queries should be sanitized
sonar.java.S2083.activate=true    # I/O function calls should not be vulnerable to path injection attacks
sonar.java.S2092.activate=true    # Creating cookies without the "secure" flag
sonar.java.S2245.activate=true    # Using pseudorandom number generators (PRNGs) is security-sensitive
sonar.java.S2647.activate=true    # "BasicAuthentication" should not be used
sonar.java.S4790.activate=true    # Using weak hashing algorithms is security-sensitive
sonar.java.S4792.activate=true    # Configuring loggers is security-sensitive
sonar.java.S4818.activate=true    # Using sockets is security-sensitive
sonar.java.S5542.activate=true    # Encryption algorithms should be used with secure mode and padding scheme

# ===============================================
# PLUGIN CONFIGURATION
# ===============================================

# Security plugins
sonar.plugins.security.enabled=true
sonar.plugins.findbugs.enabled=true
sonar.plugins.pmd.enabled=true
sonar.plugins.checkstyle.enabled=true

# External security tools integration
sonar.plugins.bandit.enabled=true
sonar.plugins.eslint.enabled=true
sonar.plugins.tslint.enabled=true

# ===============================================
# REPORTING CONFIGURATION
# ===============================================

# Report generation
sonar.report.export.path=reports/sonar
sonar.issuesReport.html.enable=true
sonar.issuesReport.lightModeOnly=false

# Report formats
sonar.report.export.formats=html,pdf,json,xml

# Issue tracking integration
sonar.github.repository=company/project
sonar.github.oauth=github_oauth_token
sonar.pullrequest.github.repository=company/project

# JIRA integration
sonar.jira.url=https://company.atlassian.net
sonar.jira.username=sonar-integration
sonar.jira.password.secured=encrypted_password

# ===============================================
# NOTIFICATION SETTINGS
# ===============================================

# Email notifications
sonar.notifications.email.enabled=true
sonar.notifications.email.smtp.host=smtp.company.com
sonar.notifications.email.smtp.port=587
sonar.notifications.email.smtp.username=sonar@company.com
sonar.notifications.email.from=sonar@company.com

# Webhook notifications
sonar.webhook.url=https://api.company.com/sonar/webhook
sonar.webhook.secret=webhook_secret_key

# ===============================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# ===============================================

# Development environment
%dev.sonar.analysis.mode=preview
%dev.sonar.quality.gate.coverage.minimum=60.0
%dev.sonar.exclusions=${sonar.exclusions},**/debug/**

# Staging environment
%staging.sonar.quality.gate.coverage.minimum=75.0
%staging.sonar.qualitygate.wait=true

# Production environment
%prod.sonar.quality.gate.coverage.minimum=85.0
%prod.sonar.qualitygate.wait=true
%prod.sonar.quality.gate.bugs.new=0
%prod.sonar.quality.gate.vulnerabilities.new=0

# ===============================================
# ADVANCED SECURITY CONFIGURATION
# ===============================================

# Taint analysis (for security vulnerabilities)
sonar.security.taint.enable=true
sonar.security.taint.sources=request,database,file
sonar.security.taint.sinks=response,log,file_write

# Secrets detection
sonar.security.secrets.enable=true
sonar.security.secrets.patterns=\
    password=.*,\
    api[_-]?key=.*,\
    secret=.*,\
    token=.*,\
    private[_-]?key=.*

# Data flow analysis
sonar.security.dataflow.enable=true
sonar.security.dataflow.depth=5

# Security hotspot review requirements
sonar.security.hotspots.reviewRequired=true
sonar.security.hotspots.assignee=security-team@company.com

# ===============================================
# COMPLIANCE AND AUDIT
# ===============================================

# Compliance frameworks
sonar.compliance.sox.enable=true
sonar.compliance.pci.enable=false
sonar.compliance.hipaa.enable=false
sonar.compliance.gdpr.enable=true

# Audit logging
sonar.audit.log.enable=true
sonar.audit.log.path=logs/sonar-audit.log
sonar.audit.log.maxSize=100MB
sonar.audit.log.maxFiles=10

# Evidence collection
sonar.evidence.collection.enable=true
sonar.evidence.retention.days=2555

# ===============================================
# PERFORMANCE AND SCALING
# ===============================================

# Analysis performance
sonar.analysis.parallel=true
sonar.analysis.threads=4
sonar.analysis.timeout=3600

# Memory settings
sonar.ce.javaOpts=-Xmx4G -Xms2G
sonar.web.javaOpts=-Xmx2G -Xms1G

# Database performance
sonar.jdbc.maxActive=60
sonar.jdbc.maxIdle=5
sonar.jdbc.minIdle=2
sonar.jdbc.maxWait=5000

# ===============================================
# METADATA AND VERSIONING
# ===============================================

# Configuration metadata
sonar.config.version=3.0.0
sonar.config.lastUpdated=2024-08-20
sonar.config.maintainer=Security Team <security-team@company.com>
sonar.config.description=Comprehensive SonarQube configuration for security and quality analysis

# Documentation
sonar.config.documentation=https://wiki.company.com/sonarqube-config
sonar.config.support=https://wiki.company.com/sonarqube-support